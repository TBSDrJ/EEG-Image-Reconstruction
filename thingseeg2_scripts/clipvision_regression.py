import sys
import os
import numpy as np
import sklearn.linear_model as skl
import pickle
import argparse
from scipy.spatial.distance import correlation
parser = argparse.ArgumentParser(description='Argument Parser')
parser.add_argument("-sub", "--sub",help="Subject Number",default=1)
args = parser.parse_args()
sub=int(args.sub)
assert sub in [1,2,5,7]

train_path = 'data/things-eeg2_preproc/train_thingseeg2_avg.npy'
train_meg = np.load(train_path, mmap_mode='r')
# train_meg = train_meg[:8000,:,:]
train_meg = train_meg.reshape(train_meg.shape[0], -1)
test_path = 'data/things-eeg2_preproc/test_thingseeg2_avg.npy'
test_meg = np.load(test_path, mmap_mode='r')
# test_meg = test_meg[:1000,:,:]
test_meg = test_meg.reshape(test_meg.shape[0], -1)
print(train_meg.shape, test_meg.shape)

## Preprocessing fMRI

train_fmri = train_meg
test_fmri = test_meg


norm_mean_train = np.mean(train_fmri, axis=0)
norm_scale_train = np.std(train_fmri, axis=0, ddof=1)
train_fmri = (train_fmri - norm_mean_train) / norm_scale_train
test_fmri = (test_fmri - norm_mean_train) / norm_scale_train

print(np.mean(train_fmri),np.std(train_fmri))
print(np.mean(test_fmri),np.std(test_fmri))

print(np.max(train_fmri),np.min(train_fmri))
print(np.max(test_fmri),np.min(test_fmri))

num_voxels, num_train, num_test = train_fmri.shape[1], len(train_fmri), len(test_fmri)


train_clip = np.load('cache/thingseeg2_preproc/extracted_embeddings/train_clipvision.npy', mmap_mode='r')
test_clip = np.load('cache/thingseeg2_preproc/extracted_embeddings/test_clipvision.npy', mmap_mode='r')
# train_clip = train_clip[:8000,:,:]
# test_clip = test_clip[:1000,:,:]

#train_clip = train_clip[:,1:,:]
num_samples,num_embed,num_dim = train_clip.shape

print("Training Regression")
reg_w = np.zeros((num_embed,num_dim,num_voxels)).astype(np.float32)
reg_b = np.zeros((num_embed,num_dim)).astype(np.float32)
pred_clip = np.zeros_like(test_clip)
for i in range(num_embed):


    reg = skl.Ridge(alpha=60000, max_iter=50000, fit_intercept=True) # old alpha=60000, optimal alpha=300000
    reg.fit(train_fmri, train_clip[:,i])
    reg_w[i] = reg.coef_
    reg_b[i] = reg.intercept_
    
    pred_test_latent = reg.predict(test_fmri)
    std_norm_test_latent = (pred_test_latent - np.mean(pred_test_latent,axis=0)) / np.std(pred_test_latent,axis=0)
    pred_clip[:,i] = std_norm_test_latent * np.std(train_clip[:,i],axis=0) + np.mean(train_clip[:,i],axis=0)

    # Compute the Euclidean distances
    euclidean_distances = np.array([np.linalg.norm(u - v) for u, v in zip(pred_clip[:,i], test_clip[:,i])])
    correlation_distances = np.array([correlation(u, v) for u, v in zip(pred_clip[:,i], test_clip[:,i])])
    # Compute the average Euclidean distance
    average_euclidean_distance = euclidean_distances.mean()
    correlations = (1 - correlation_distances).mean()
    
    print(i,reg.score(test_fmri,test_clip[:,i]), average_euclidean_distance, correlations)
    

# np.save('data/predicted_features/subj{:02d}/nsd_clipvision_predtest_nsdgeneral.npy'.format(sub),pred_clip)
    # np.save('data/predicted_features/subj{:02d}/nsd_clipvision_predtest_nsdgeneral_assumehrf.npy'.format(sub),pred_clip)
# subject = 'BIGMEG1'
# save_dir = 'cache/predicted_embeddings/' + subject + '/'
# if not os.path.exists(save_dir):
#     os.makedirs(save_dir)
# np.save(save_dir + f'thingsmeg_regress_clipvision1b_sub-{subject}.npy', pred_clip)
save_dir = 'cache/thingseeg2_preproc/predicted_embeddings/'
if not os.path.exists(save_dir):
    os.makedirs(save_dir)
np.save(save_dir + 'thingseeg2_regress_clipvision.npy', pred_clip)


datadict = {
    'weight' : reg_w,
    'bias' : reg_b,

}

# with open('data/regression_weights/subj{:02d}/clipvision_regression_weights.pkl'.format(sub),"wb") as f:
# with open('data/regression_weights/subj{:02d}/clipvision_regression_weights_assumehrf.pkl'.format(sub),"wb") as f:
#   pickle.dump(datadict,f)
# subject = 'BIGMEG1'
# save_dir = 'cache/regression_weights/' + subject + '/'
# if not os.path.exists(save_dir):
#     os.makedirs(save_dir)
# with open(save_dir + f'thingsmeg_regress_clipvision1b_weights_sub-{subject}.pkl', "wb") as f:
#     pickle.dump(datadict,f)
save_dir = 'cache/thingseeg2_preproc/regression_weights/'
if not os.path.exists(save_dir):
    os.makedirs(save_dir)
with open(save_dir + 'thingseeg2_regress_clipvision_weights.pkl', "wb") as f:
    pickle.dump(datadict,f)

# 0 0.01594931018798976 0.8303167888972689 0.6559494381793088                                                                                                                                                        
# 1 0.0016460355455040106 0.6112229933778178 0.537748115351571                                                                                                                                                       
# 2 0.0002266220692885484 0.6411703997588717 0.5240192782600436                                                                                                                                                      
# 3 0.002020097463936799 0.6346537255982181 0.5288268591732674                                                                                                                                                       
# 4 0.0008298691854348583 0.6426629723546814 0.5178000333049964                                                                                                                                                      
# 5 0.001533194087213142 0.6368419149030832 0.5215165701369877                                                                                                                                                       
# 6 -0.0003662630101093489 0.6536470345348405 0.5085677038118992                                                                                                                                                     
# 7 -0.0020214152514421036 0.6397050282967431 0.5225775870443182                                                                                                                                                     
# 8 0.0012308053414185106 0.6433174209703836 0.5199173747180023                                                                                                                                                      
# 9 -0.0016424450021523724 0.647002637091379 0.510800919442238                                                                                                                                                       
# 10 0.0005382834329182062 0.6451044239846102 0.5097308666040204                                                                                                                                                     
# 11 0.0007378535351295067 0.646514245560048 0.5150166466845058                                                                                                                                                      
# 12 -0.0008828590421417992 0.6533069057587768 0.5061275578203409                                                                                                                                                    
# 13 0.00016320304678135578 0.6415228356320972 0.5174875208391246                                                                                                                                                    
# 14 0.0018870016162531235 0.6362842752118891 0.5161968036794863                                                                                                                                                     
# 15 0.00046960138921022415 0.6375546128680343 0.5264253609898394                                                                                                                                                    
# 16 0.0014790311118515244 0.6227753947258774 0.5326473103249618                                                                                                                                                     
# 17 0.0006846356357535262 0.6379364042929335 0.5144106486207891                                                                                                                                                     
# 18 -0.0022027430460513924 0.6634240673554953 0.5041051330109231                                                                                                                                                    
# 19 -0.000794226263946829 0.6634535223064779 0.5000373488727056                                                                                                                                                     
# 20 -0.0009942600292045206 0.6676599352822487 0.49694385669168073                                                                                                                                                   
# 21 -0.0016569980082856506 0.6730300838506862 0.49186065564683723                                                                                                                                                   
# 22 -0.0001705481744902577 0.6726847971106663 0.49510996776718286                                                                                                                                                   
# 23 -0.00013928740495333948 0.674409294190413 0.4923048442675119                                                                                                                                                    
# 24 -0.0005972131326902587 0.6725827043046607 0.49595820708164057                                                                                                                                                   
# 25 0.0002798866278875643 0.6554278935444579 0.5100789923812968                                                                                                                                                     
# 26 -0.0011476812271615032 0.6752356049675753 0.4923303611716966                                                                                                                                                    
# 27 -0.001101884913876572 0.6726609671279385 0.4944693292420121                                                                                                                                                     
# 28 -0.002148743603845276 0.6745854077949035 0.49160593984652595                                                                                                                                                    
# 29 -0.001695108023940092 0.667104893482985 0.5000159957479012                                                                                                                                                      
# 30 -0.001455691502247513 0.649021461867179 0.5165595168856596                                                                                                                                                      
# 31 -0.0019466898608935176 0.66270806632969 0.5002197086214931                                                                                                                                                      
# 32 0.0013852165234524924 0.6404468114019217 0.5115226676053208                                                                                                                                                     
# 33 0.0028375606151231744 0.6032416769807754 0.5142662008066441                                                                                                                                                     
# 34 -0.0005612488993281513 0.6600218900036219 0.5104757584071229                                                                                                                                                    
# 35 -0.0010156079927297011 0.6634084347104497 0.5041116489629358                                                                                                                                                    
# 36 -0.0014109564089110425 0.6813152040573851 0.4842648114588312                                                                                                                                                    
# 37 0.0001815576930283763 0.6750693586233235 0.49636087550822805                                                                                                                                                    
# 38 -0.0005972530553130436 0.6888566657993053 0.4817876184390872                                                                                                                                                    
# 39 0.000529909002637381 0.6848398030103359 0.47924277617244626                                                                                                                                                     
# 40 -0.0006842259278533073 0.687223386517635 0.47479390688023204                                                                                                                                                    
# 41 -5.979018090926019e-05 0.6834412070944211 0.48182426954740437                                                                                                                                                   
# 42 -0.000655097096690095 0.6903795840207195 0.47425335789013645                                                                                                                                                    
# 43 -0.000397241615661494 0.681865382104425 0.4842343442340634                                                                                                                                                      
# 44 -0.001235796817043449 0.6864462802838771 0.4791100816769105                                                                                                                                                     
# 45 -0.0006499292723278717 0.6766271938254573 0.49020363524328714                                                                                                                                                   
# 46 -0.0013598661233570504 0.6494782488491093 0.508543305382338                                                                                                                                                     
# 47 -0.0036732342422749267 0.6660580325857677 0.4925195827711791
# 48 0.0001231263164808086 0.6472114831551451 0.5027364102862271
# 49 0.0005989900324188507 0.6431106524317488 0.5121305343687329
# 50 -0.002026395130405801 0.672731565795518 0.4943904490453527
# 51 -0.0013506493080827403 0.6698535966898288 0.4994809817338497                                                                                                                                          [153/1875]
# 52 -0.00041091022176916353 0.6854813977778821 0.47867533430369924                                                                                                                                                  
# 53 -0.0002440704644663511 0.6885609376551427 0.4803288453446804                                                                                                                                                    
# 54 0.000572360084105818 0.6928930583096456 0.4762800695341458                                                                                                                                                      
# 55 -0.0010177500177067191 0.6994581985777026 0.46335815194973873                                                                                                                                                   
# 56 0.000517488791199385 0.6949586844357043 0.4710611520664785                                                                                                                                                      
# 57 -0.0010455814115964848 0.7033970920382623 0.45800955411880223                                                                                                                                                   
# 58 -0.0006849135984374712 0.7004647040760372 0.4649144086013544                                                                                                                                                    
# 59 0.00018716338707871444 0.6972515856498862 0.46785217229987763                                                                                                                                                   
# 60 -0.0008184634000395578 0.6993873161590756 0.4648553621603011                                                                                                                                                    
# 61 -0.0011986831876529306 0.6910514060520735 0.47246649331048773                                                                                                                                                   
# 62 -3.270228214254954e-05 0.6747501037215966 0.4877555816342024                                                                                                                                                    
# 63 -0.0033945151911420808 0.6750549348381234 0.47971320666303646                                                                                                                                                   
# 64 -0.0006850867302518361 0.6581242072164656 0.49231907326469565                                                                                                                                                   
# 65 0.0014491527955211147 0.6353490052822892 0.49817079346247367                                                                                                                                                    
# 66 0.00021898167367437297 0.6752629409534814 0.49490861317063456                                                                                                                                                   
# 67 -0.0011563894477686282 0.6863470359786732 0.4771831056052634                                                                                                                                                    
# 68 -0.0009372026959826248 0.6946874057499663 0.4711812326181606                                                                                                                                                    
# 69 -5.521423768468347e-05 0.699906609473109 0.46267668225111064                                                                                                                                                    
# 70 0.0006121698059269233 0.7052329333073564 0.4608736732955378                                                                                                                                                     
# 71 -0.0005428877026352761 0.7116149841125473 0.45798158732373756                                                                                                                                                   
# 72 -7.470318112787633e-05 0.7106086411768875 0.45452894997165894                                                                                                                                                   
# 73 -2.087393847680028e-06 0.696899182757071 0.46943125894834553                                                                                                                                                    
# 74 -9.387896941746218e-05 0.7046613048760463 0.4591172937785277                                                                                                                                                    
# 75 -0.0012370567080315638 0.7097275638950298 0.45679725083527956                                                                                                                                                   
# 76 -0.0005395495252267829 0.7030778668225841 0.46143018639166317                                                                                                                                                   
# 77 -7.567422630094251e-06 0.6943809508316657 0.46933488970629883                                                                                                                                                   
# 78 -0.00036557008291690133 0.6820511055852218 0.47976847912507653                                                                                                                                                  
# 79 -0.0001198716827664935 0.6772412392263718 0.4875658155536087                                                                                                                                                    
# 80 -0.0010757295712168094 0.6621887846134914 0.4854568527740589                                                                                                                                                    
# 81 -0.00039940181348437754 0.6573420444197258 0.4830630808450501                                                                                                                                                   
# 82 -0.00042708993972724656 0.6826462094695978 0.48707895635693466                                                                                                                                                  
# 83 -0.0012707824510379791 0.6950667337722882 0.47221091136082066                                                                                                                                                   
# 84 -0.0006746194203398588 0.700371556100002 0.46725928245098947                                                                                                                                                    
# 85 -0.0004484901869785958 0.7118896142166866 0.46019240536116074                                                                                                                                                   
# 86 0.00027228964861616473 0.7117528355260836 0.46072720191042404                                                                                                                                                   
# 87 -0.0006184902458357902 0.7188944337195946 0.45110725534104307
# 88 -0.0008393272310827129 0.7215369709110462 0.44087376008479007
# 89 0.00044184632262247206 0.7110090220821484 0.4621169256793938
# 90 -0.0008958434847644966 0.7123786199360432 0.4568485152195618
# 91 -0.0012788487796714966 0.714481844552115 0.4494306849712607
# 92 -0.0008987514250015494 0.7036696327285707 0.45995280960348284
# 93 -2.0697899345089508e-05 0.7056020893992938 0.45660772958831225
# 94 -0.0012707879178935606 0.6918372677244179 0.46588049837505624
# 95 -0.00032275269550416505 0.6806600547502586 0.48083853235724805
# 96 0.00023578236207000988 0.6568278429540751 0.4936808552393964
# 97 0.00036213673067062745 0.6566549183130972 0.49364777241880153
# 98 0.00013338418764141975 0.6825358933757216 0.4864728722841968
# 99 -0.0006887411789031837 0.6934832491975714 0.4699861987999252
# 100 6.189692284388444e-05 0.7002411012808172 0.46729065597427777
# 101 -0.0004940255788154166 0.7125583427920208 0.45878869665452515                                                                                                                                                  
# 102 0.0003914706487460334 0.7140035317193402 0.45574326713594987                                                                                                                                                   
# 103 -0.0004334630383388124 0.7225269409787758 0.4477305579610241                                                                                                                                                   
# 104 -0.00017016388950205876 0.7195036510398896 0.45004405652260376                                                                                                                                                 
# 105 -0.00022769123158246926 0.718696199120583 0.45382326157514485                                                                                                                                                  
# 106 -0.0015093231073537996 0.7175532920019292 0.45322872527478325                                                                                                                                                  
# 107 -0.001751843080868204 0.7166900584707727 0.4448125272115652                                                                                                                                                    
# 108 -0.0010277698425341362 0.7070727888309289 0.4592835820093274                                                                                                                                                   
# 109 -0.0013464592171027216 0.7083865224185064 0.4530618316713526                                                                                                                                                   
# 110 -0.0006931218587365685 0.6903668300344782 0.4693468381593507                                                                                                                                                   
# 111 -0.00019411100665631164 0.6918628775326376 0.4685185196235565                                                                                                                                                  
# 112 0.0006669689586757751 0.6643376307622924 0.48320585384407766                                                                                                                                                   
# 113 0.0014022086498003171 0.6496613352682976 0.48570591900132265                                                                                                                                                   
# 114 -0.000931657635646425 0.6851698193225676 0.4849342390786136                                                                                                                                                    
# 115 -0.0003566482349834351 0.6889098464405312 0.47916912715266013                                                                                                                                                  
# 116 0.00010257649269000922 0.7029732297184461 0.4657995580892927
# 117 -0.0006320156403476783 0.7134301707570134 0.45582575128935043
# 118 -0.00028366299398952037 0.7184260929124587 0.4502844397879366
# 119 -0.00045479891525455505 0.7198699908611533 0.44983265645044285
# 120 3.202683756908118e-05 0.7195884858953414 0.4535387294980909
# 121 -0.0010159828155876566 0.7208723453407063 0.45320075859112946
# 122 -0.001316447837871816 0.7199481621629323 0.44695178746278147
# 123 -0.0019161529012956247 0.71951289293261 0.44113030895368593
# 124 -0.0019200072575956495 0.7152321384133137 0.4429223950169178
# 125 -0.0020978802749649877 0.7096569733225232 0.4546928723655317
# 126 -0.0008438800140828866 0.6966195744144216 0.4671179831095874
# 127 0.00013415266756138878 0.6882220565805093 0.47941474882037144
# 128 -0.0005299938009633464 0.6671008488663523 0.48457378983833543
# 129 0.0014211817369515895 0.6556151788546876 0.4925676492674241
# 130 -0.0031877502148311074 0.6939689436412736 0.47249751330686807
# 131 -0.001235978270875403 0.6990353582021461 0.46832790470057667
# 132 -0.0010790497350186424 0.7053426489610441 0.4603228475697588
# 133 -0.0005589927681657936 0.7090737722418383 0.4597164451673869
# 134 -0.0017712746274320228 0.7215802721424852 0.44927422641608245
# 135 -0.002411281957480265 0.7182129273104303 0.4565123277015323
# 136 -0.001660513908853374 0.726761069156939 0.4447494765460355
# 137 -0.001871892556176656 0.7226121752700797 0.4474648005201392
# 138 -0.0022403965740141214 0.7285331532671562 0.4402508532135738
# 139 -0.002500589487277651 0.7245304952888835 0.4403976917202491
# 140 -0.001614763182742911 0.7230502076835245 0.4450279883460822
# 141 -0.0017666328200908732 0.7087766530706011 0.4552905059536782
# 142 -0.0008872240071459925 0.6986040252983302 0.46659003078714945
# 143 0.00039470051086652226 0.6807094220193196 0.48301039284494907
# 144 0.0028381836689597637 0.6639192046299758 0.4883454122261195
# 145 -0.0011596055993765098 0.6551517044919137 0.4846555877892268
# 146 -0.0012375344657221167 0.6970805553468367 0.46951283330796195
# 147 -0.00012422517577430174 0.6941670234362423 0.47186732515666774
# 148 -0.0005042961153698041 0.6992707566804444 0.47058825184037134
# 149 -0.002247066587342019 0.7037501049849791 0.4627332541105443
# 150 -0.0008950719724255361 0.7134381768729509 0.4545937302468158
# 151 -0.0012881333818024457 0.7168400207474478 0.4544206012814777                                                                                                                                          [53/1875]
# 152 -0.0017045519189143286 0.717828072286701 0.4549397642353084                                                                                                                                                    
# 153 -0.001137570309517963 0.7177307257645822 0.44811411276984875                                                                                                                                                   
# 154 -0.002113774892012674 0.7249265860429994 0.4403382995298234                                                                                                                                                    
# 155 -0.0010503622133898806 0.7183713852768566 0.45390687238387                                                                                                                                                     
# 156 -0.0020401376405524063 0.7192586113237717 0.44518319074806856                                                                                                                                                  
# 157 -0.0007671327901412301 0.7033884914797511 0.4603282073752176                                                                                                                                                   
# 158 -0.00018493609049458214 0.6939714485154108 0.47122577953739514                                                                                                                                                 
# 159 0.0016428158538485816 0.6830081862136157 0.4841902828605961                                                                                                                                                    
# 160 0.0014719342085181507 0.658529506801354 0.4916903313871569                                                                                                                                                     
# 161 0.0003616921859182747 0.6541307365724397 0.4817787012324385                                                                                                                                                    
# 162 -0.0007254696997440378 0.6866623144311929 0.47859661529566083                                                                                                                                                  
# 163 -0.0005097544266726247 0.6930200538941105 0.47477390382078455
# 164 -0.0001114857622134937 0.7050532835554233 0.4649805781272828
# 165 -0.0007360214466007833 0.707081234870612 0.46387272798926793
# 166 -0.0002742224028943568 0.7119405772510683 0.46001500895733555
# 167 -0.00046921472042186097 0.7169351998583253 0.455458905682131
# 168 -0.0017700470418928922 0.717847519504979 0.4544431228872834
# 169 -0.002277032766674759 0.7087661737160302 0.4610723456101596
# 170 -0.0010047256262800377 0.7143166357564439 0.4573463701006486
# 171 -0.00020177055966014287 0.7090949505356912 0.4625217262027019
# 172 -0.002194355348556555 0.713077075224431 0.4547089942824541
# 173 -0.00014610237922864526 0.699346703350701 0.4631565588902435
# 174 0.0011366578518792853 0.6844910096078979 0.4810055279582096
# 175 0.002190652101283259 0.6780471836462122 0.4890193931886475
# 176 -0.0009722491211112278 0.6616427631265102 0.49027944622375375
# 177 -0.0006570925275580869 0.6644125888447283 0.4783504536602935
# 178 -0.0012306863242119196 0.6859376281024745 0.4771509111450557
# 179 -0.001405317363333148 0.6863044823941001 0.484015176889603
# 180 -0.0018453768450147352 0.6941830695901962 0.4731404894697129
# 181 -0.0017789100144345923 0.6978031105874828 0.4758827828983522
# 182 -0.0009732330174693887 0.7094013108984992 0.4624380928411634
# 183 -0.0014540557164740397 0.706438204671798 0.46402320752928305
# 184 -0.0012396557122667023 0.7090452109704332 0.4654921866108991
# 185 -0.000986740552200178 0.7034427393951097 0.465296556880871
# 186 -0.001997510328026612 0.7120487323114524 0.46236007768029735
# 187 -0.0007220938386630622 0.7060964910027162 0.46445549286265725
# 188 -0.001961816131293185 0.7059944913971954 0.46101931090945086
# 189 0.00020717938637787866 0.686270811251038 0.47918037089766286
# 190 -0.0006022742882737134 0.6785334805286318 0.48574503474434183
# 191 0.001113921090525869 0.6679726681273346 0.5016363360128533
# 192 -3.797458579414143e-06 0.6538295457567981 0.49451688659316334
# 193 -0.002187159090389775 0.6468589430536013 0.49310690484112313
# 194 -0.0015339191936180354 0.669290634422322 0.49839217427531707
# 195 -0.0018075929268050225 0.6778072905410119 0.4890400469255368
# 196 -0.0010813960824839367 0.6855268566469047 0.4812679053262858
# 197 -0.0010895390537269255 0.6900176198613592 0.4773144481482644
# 198 -0.001623225065793663 0.6956537994841365 0.47391311786798207
# 199 -0.001317769870242315 0.6950706928394476 0.47442389110045197
# 200 -0.0005143694012848137 0.6978200446443816 0.47458449368615535
# 201 -0.0013768516228181487 0.6971422968605608 0.4743126482754101                                                                                                                                                   
# 202 -0.0003595782454283523 0.694602555004513 0.47857460906367905                                                                                                                                                   
# 203 -9.550448827170723e-05 0.6915634977160471 0.47935462001388573                                                                                                                                                  
# 204 -6.140168281082538e-05 0.6882589161726855 0.4814083354524758                                                                                                                                                   
# 205 -0.0009722332277626646 0.679916596378884 0.48955384851664374
# 206 -0.00032827124299854293 0.6769525818936978 0.49192114862756214
# 207 -0.00030905077219741517 0.6734804461675669 0.49523913422693744
# 208 0.0012048144525621497 0.6561644649522654 0.49006758958981045
# 209 0.0008811607716258195 0.6338100757389354 0.4916259519317518
# 210 -0.0023287354778877465 0.6673581696035119 0.5003814889230429
# 211 -0.00020249740379682857 0.6722749999522861 0.4978774962908627
# 212 -0.0015203204658549953 0.6782607471960896 0.49111911333318425
# 213 -0.0011782513530040942 0.6798779877685515 0.4919627525832792
# 214 -0.0014022665261178222 0.6806259134345071 0.4914593104846368
# 215 -0.0007270383821609914 0.6853657464661163 0.48596709851500075
# 216 -0.002558035018777467 0.684153949036143 0.4852908800063481
# 217 -0.0014161910414409893 0.6864311412727173 0.4821705186090807
# 218 3.1385037348640475e-05 0.686089269957734 0.48965064751108245
# 219 -0.0008308839831063717 0.6797344619174704 0.4906260784620591
# 220 -0.0006980366514935939 0.6770803709214759 0.4963711484676023
# 221 -0.002469601233115675 0.6796244212368581 0.48655371012001664
# 222 -0.0011787743424825825 0.6593352001808919 0.5065608489992826
# 223 -0.00016586513978676245 0.6676911831042756 0.5034807703304888
# 224 0.00012679723202392115 0.6534256511736458 0.49250788020455816
# 225 0.0010002868402091657 0.6424622550732831 0.5065951744087801
# 226 -0.0008840915317755734 0.6637008139595544 0.5132638717927716
# 227 -0.0010655532460387956 0.6570777038820573 0.5132502454679918
# 228 -0.0011102914987736448 0.6674939773027069 0.5082522317061986
# 229 0.00017324666850724452 0.6698398168835815 0.50635007815497
# 230 -4.912782859828208e-05 0.6617747828733431 0.5119958476927008
# 231 -0.0028392289110578013 0.6691618889197782 0.5010110547019798
# 232 -0.001825979016262326 0.6712078711754776 0.5027209379973737
# 233 -0.0029374237321756484 0.6683946332522492 0.5030000336107192
# 234 -0.0016248165230676095 0.6685917230320055 0.5008661615273438
# 235 -0.0030899610769986735 0.664507905638581 0.5052175724182765
# 236 -0.0012551402154836425 0.6702391307613483 0.5014791869468676
# 237 -0.0007150680342498883 0.6654760402171951 0.5082840715841564
# 238 -0.00024148458426986817 0.6563278155189206 0.5133438675483661
# 239 -0.0003355649733715915 0.6568449875939012 0.5176252344163199
# 240 -0.0006029400220654698 0.6495879709072045 0.5072004780509625
# 241 0.002961211866567597 0.6059287240875417 0.5374190998727628
# 242 0.0004960736796902145 0.6371913430792511 0.5305953868839288
# 243 -0.000460188759742931 0.6350238708481113 0.5265876415976974
# 244 0.0016834346169720463 0.6340870651542968 0.5313159955849936
# 245 0.0010340671336553956 0.638198475251733 0.5266591230317448
# 246 -0.00030935445760740956 0.6529061276847957 0.5206326569717932
# 247 0.00027722033997144743 0.6464575431877942 0.5218212409644825
# 248 0.0010450314922951145 0.6453734259167052 0.5227741738041763
# 249 0.0025499381915158187 0.6432136192337115 0.5220424966451014
# 250 0.0001281724592345451 0.6468736768094062 0.5221958365076985
# 251 0.0005789142207716764 0.6424349224230184 0.5175066722210342
# 252 0.0008128721470047601 0.6482061644684959 0.5215556834128988
# 253 0.001462862153615885 0.6447141770081172 0.5210691088936941
# 254 0.0032778585622153223 0.6116824659185568 0.5472470125284549
# 255 -9.636024643229896e-05 0.6297828295129557 0.5382545261902274
# 256 0.0010342795404211153 0.6075748940700595 0.5429726669661323